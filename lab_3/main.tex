\documentclass[a4paper]{article}
\input{header}
\begin{document}
\large
\begin{center}
    Санкт-Петербургский политехнический университет\\
    Высшая школа прикладной математики и\\вычислительной физики,\\ 
    Физико-механический институт\\
    \vspace{3em}
    Направление подготовки\\
    01.03.02 «Прикладная математика и информатика»\\
    \vspace{10em}
    \Large
    Отчет по лабораторной работе №3 \\
    по дисциплине «Интервальный анализ»
    \vspace{19em}
    \large
\end{center}
Выполнил студент гр. 5030102/80201\\
Кирпиченко С. Р.\\
Руководитель\\
Баженов А. Н.
\vspace{10em}
\begin{center}
    Санкт-Петербург\\
    2021
\end{center}
\thispagestyle{empty}
\newpage
\tableofcontents
\addtocontents{toc}{~\hfill\textbf{Страница}\par}
\newpage
\listoffigures
\addtocontents{lof}{~\hfill\textbf{Страница}\par}
\newpage
\section{Постановка задачи}
Дана ИСЛАУ 
\begin{equation}\label{islau}
    \begin{cases}
    [0,\:2]\cdot x_1+[1,\:3]\cdot x_2=[3,\:7]\\
    x_1 - [2,\:4]\cdot x_2=0\\
    [1,\:3]\cdot x_1=[5,\:7]\\
    \end{cases}
\end{equation}
Для нее необходимо провести вычисления и привести иллюстрации:
\begin{itemize}
    \item Максимума распознающего функционала
    \item Достижения разрешимости ИСЛАУ за счет коррекции правой части
    \item Достижения разрешимости ИСЛАУ за счет коррекции матрицы в целом
    \item Достижения разрешимости ИСЛАУ за счет коррекции матрицы построчно
    \item Оценок вариабельности решения
\end{itemize}

\section{Теория}
\subsection{Распознающий функционал}
Распознающим называется функционал 
\begin{equation*}
    \mathrm{Tol}(x)=\mathrm{Tol}(x,\mbf{A},\mbf{b})=\min_{1\leq i\leq m}\left\{\rad{\mbf{b}_i}-\left|\imid{\mbf{b}_i}-\sum_{j=1}^n \mbf{a}_{ij}x_j\right|\right\}
\end{equation*}
\begin{equation*}
    x\in\Xi_{\mathrm{tol}}\Leftrightarrow\mathrm{Tol}(x)\geq0
\end{equation*}
$\mathrm{Tol}(x)$ - ограничен, вогнут. Он всегда достигает конечного максимума на $\mbb{R}^n$. Таким образом, найдя максимум данного функционала, можно судить о пустоте допускового множества решений ИСЛАУ. Если $\max\limits_{x\in\mbb{R}^n}\mathrm{Tol}(x)\geq0$, то допусковое множество не пусто. В противном случае $\Xi_{\mathrm{tol}}=\varnothing$. Обратные утверждения также верны.
\subsection{Достижение разрешимости ИСЛАУ за счет коррекции правой части}
Общая схема метода заключается в добавлении к каждой компоненте правой части ИСЛАУ величины $K\cdot\nu_i\cdot[-1;1]$, где $i$ - номер компоненты, $\nu_i$ - вес, задающий относительное расширение $i$-й компоненты, $K$ - общий коэффициент расширения вектора $\mbf{b}$. В данной работе используются значение $\nu_i=1\;\forall i=\overline{1,3}$. Подобрав $K$ таким образом, чтобы выполнялось $ K +\max\limits_{x\in\mbb{R}^n}\mathrm{Tol}(x)\geq0$, получим разрешимую систему с непустым допусковым множеством.
\subsection{Достижение разрешимости ИСЛАУ за счет коррекции матрицы}
Общая схема метода заключается в модификации исходной матрицы ИСЛАУ. Производим замену $A$ на $A\ominus K\cdot N\cdot\mbf{E}$ где $ N=\{\nu_i\}$ - матрица весов, $K$ - общий коэффициент сужения $A$, $\mbf{E}$ состоит из $[-1,1]$ на месте интервальных величин и $0$ на месте скаляров. При выполнении процедуры необходимо следить за тем, чтобы мы оставались в рамках $\mbb{IR}$. В первом варианте коррекции матрицы $ N$ - единичная матрица, во втором - $ N=\mathrm{diag}\{\nu_i\}$. 
\subsection{Оценки вариабельности решения}
Для оценки вариабельности решений предлагается использовать абсолютную и относительную оценки:
$$\mathrm{ive}(\mbf{A},\mbf{b})=\min\limits_{A\in\mbf{A}}\mathrm{cond}\:A\cdot||\mathrm{argmax}\:\mathrm{Tol}(x)||\frac{\max\limits_{x\in\mbb{R}^n}\mathrm{Tol}(x)}{||\mbf{b}||}$$
$$\mathrm{rve}(\mbf{A},\mbf{b})=\min\limits_{A\in\mbf{A}}\mathrm{cond}\:A\cdot\max\limits_{x\in\mbb{R}^n}\mathrm{Tol}(x)$$
\section{Реализация}
Для осуществления вычислений и визуализации результатов использовалась среда Matlab с библиотекой интервальной арифметики IntLab. Также использовалась функция tolsolvty для нахождения максимума распознающего функционала. Минимальное число обусловленности вычислялось стохастическим методом. 
\section{Результаты}
Изначальная ИСЛАУ имеет пустое допусковое множество, так как максимум распознающего функционала в точке $(3,1)$ равен -2. Этот максимум здесь и далее обозначен звездочкой.
\begin{figure}[H]
    \centering
    \includegraphics[width=15cm]{img/maxtol.png}
    \caption{График $\mathrm{Tol}(x,\mbf{A},\mbf{b})$}
    \label{fig:origtol}
\end{figure}
Для достижения разрешимости правая часть системы была заменена по описанной схеме с коэффициентом расширения  $K=1.5\cdot|\max\limits_{x\in\mbb{R}^n}\mathrm{Tol}(x)|=3$. После коррекции максимум распознающего функционала стал равен $1$ в точке $(3,1)$.
\begin{figure}[H]
    \centering
    \includegraphics[width=12cm]{img/maxtol b.png}
    \caption{График $\mathrm{Tol}(x,\mbf{A}, \hat{\mbf{b}})$ для ИСЛАУ с правленной правой частью}
    \label{fig:btol}
\end{figure}
Допусковое множество решений стало непустым, оно отмечено на графике пунктиром. $\mathrm{ive}\:(\mbf{A}, \hat{\mbf{b}})\approx0.24,\;\mathrm{rve}\:(\mbf{A}, \hat{\mbf{b}})\approx1.1$. На графике изображены квадратные брусы с центром в точке максимума $\mathrm{Tol}\:(x)$ и радиусом $\mathrm{ive}$ и $\mathrm{rve}$.
\begin{figure}[H]
    \centering
    \includegraphics[width=12cm]{img/ive rve b.png}
    \caption{График $\Xi_{\mathrm{tol}}$ и оценки вариабельности для ИСЛАУ с правленной правой частью}
    \label{fig:biverve}
\end{figure}
Для процедуры коррекции матрицы в целом был выбран коэффициент сжатия $K=1$. После коррекции матрица системы стала точечной, максимум распознающего функционала стал равен $0$ в точке $(3,1)$.
\begin{figure}[H]
    \centering
    \includegraphics[width=12cm]{img/maxtol a.png}
    \caption{График $\mathrm{Tol}(x,\hat{\mbf{A}}, \mbf{b})$ для ИСЛАУ с правленной матрицей в целом}
    \label{fig:atol}
\end{figure}
Допусковое множество решений стало непустым, оно отмечено на графике пунктиром. $\mathrm{ive}\:(\hat{\mbf{A}}, \mbf{b})=\mathrm{rve}\:(\hat{\mbf{A}}, \mbf{b})=0$. 
\begin{figure}[H]
    \centering
    \includegraphics[width=12cm]{img/ive rve a.png}
    \caption{График $\Xi_{\mathrm{tol}}$ для ИСЛАУ с правленной матрицей в целом}
    \label{fig:aiverve}
\end{figure}
Для процедуры коррекции матрицы построчно были выбраны веса $\{0.55, 1, \frac{2}{3}\}$, коэффициент сжатия остался таким же, $K=1$. После коррекции максимум распознающего функционала стал равен $0$ в точке $(3,1)$. Допусковое множество стало точечным, $\mathrm{ive}\:(\check{\mbf{A}}, \mbf{b})=\mathrm{rve}\:(\check{\mbf{A}}, \mbf{b})=0$.
\begin{figure}[H]
    \centering
    \includegraphics[width=15cm]{img/maxtol an.png}
    \caption{График $\mathrm{Tol}(x,\check{\mbf{A}}, \mbf{b})$ и $\Xi_{\mathrm{tol}}$ для ИСЛАУ с правленной матрицей построчно}
    \label{fig:aniverve}
\end{figure}
\section{Обсуждение}
\begin{enumerate}
    \item Коррекция правой части с коэффициентом расширения $K$ влечет увеличение значения максимума распознающего функционала на $K$.
    \item Коррекция правой части не меняет форму распознающего функционала, не меняет положение максимума.
    \item Исходя из результатов графика \ref{fig:biverve}, можно заключить, что с помощью $\mathrm{ive}$ и $\mathrm{rve}$ можно оценить $\Xi_{\mathrm{tol}}$. На данном графике квадрат с центром в точке максимума $\mathrm{Tol}(x)$ и стороной $2\cdot\mathrm{ive}\:(\mbf{A}, \hat{\mbf{b}})$ дает внутреннюю оценку допускового множества, аналогичный квадрат со стороной $2\cdot\mathrm{rve}\:(\mbf{A}, \hat{\mbf{b}})$ - внешнюю. Обе оценки довольно точные. Вероятно, рассматриваемые числовые характеристики пригодны для оценки $\Xi_{\mathrm{tol}}$ в многомерных случаях, когда затруднительно найти нулевую границу распознающего функционала.
    \item Коррекция матрицы ИСЛАУ меняет форму распознающего функционала. Не смотря на то, что формально программа всегда обозначала одну и ту же точку за точку искомого максимума, в случае коррекции матрицы в целом мы получили 0 в качестве значения максимума и полосу в качестве $\Xi_{\mathrm{tol}}$, следовательно, любая точка из этого отрезка будет являться точкой максимума. Это, в свою очередь, обозначает, что положением максимума также можно управлять, корректируя матрицу системы.
    \item С помощью внесения весов можно также менять форму распознающего функционала и форму допускового множества. С помощью весов $\Xi_{\mathrm{tol}}$ из отрезка (график \ref{fig:aiverve}) было сжато до точки (график \ref{fig:aniverve}).
    \item При вырождении $\Xi_{\mathrm{tol}}$ по хотя бы одной координате оценки вариабельности становятся равны 0.
\end{enumerate}
\section*{Исходный код}
С исходным кодом программы и отчета можно ознакомиться в репозитории \url{https://github.com/Stasychbr/IntervalArith}.
\end{document}
